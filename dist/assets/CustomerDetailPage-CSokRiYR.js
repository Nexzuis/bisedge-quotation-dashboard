import{j as e,A as Z,m as v}from"./vendor-motion-BTi7gxEc.js";import{r as c,u as R,m as X}from"./vendor-react-CUuYCEpB.js";import{c as J,a0 as V,u as q,a2 as L,_ as y,X as U,f as _,t as b,U as ee,T as M,k as O,a as se,al as k,am as S,G as ae,ai as te,F as $,ao as ie,ap as le,aq as re,ar as ne,as as ce,at as de,d as oe,au as P}from"./index-BQ8GchdQ.js";import{P as z,I as u,u as D}from"./useContacts-DXtQf3j4.js";import{P as me}from"./PipelineStageBadge-CYF83_GZ.js";import{u as T,P as ue,U as xe}from"./useActivities-DDyYIwR2.js";import{P as Y,A as he}from"./plus-Chd8VMT3.js";import{A as I}from"./activity-xnXCEB-V.js";import{A as ge,S as K}from"./sticky-note-CoNOk4VY.js";import"./vendor-zustand-DbidXgKt.js";import"./vendor-dexie-TCJlnc2g.js";import"./vendor-pdf-tjGXvEUX.js";import"./vendor-supabase-DxKkahmj.js";import"./trophy-C3NEYXtY.js";const fe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ve=J("star",fe);function pe({company:a,onUpdate:i}){const[l,g]=c.useState(!1),[s,m]=c.useState({...a}),{updateCompany:h}=V(),{logStageChange:d}=T(),{user:f}=q(),p=async()=>{try{s.pipelineStage!==a.pipelineStage&&await d(a.id,a.pipelineStage,s.pipelineStage,f?.id||""),await h(a.id,{name:s.name,tradingName:s.tradingName,registrationNumber:s.registrationNumber,vatNumber:s.vatNumber,industry:s.industry,website:s.website,phone:s.phone,email:s.email,address:s.address,city:s.city,province:s.province,postalCode:s.postalCode,country:s.country,estimatedValue:Number(s.estimatedValue)||0,creditLimit:Number(s.creditLimit)||0,paymentTerms:Number(s.paymentTerms)||30,pipelineStage:s.pipelineStage,notes:s.notes,tags:s.tags}),b.success("Company updated"),g(!1),i()}catch{b.error("Failed to update company")}},n=(t,x)=>m(j=>({...j,[t]:x})),r=(t,x)=>{const j=[...s.address];j[t]=x,n("address",j)};return e.jsx("div",{className:"glass rounded-xl p-5",children:e.jsx(Z,{mode:"wait",children:l?e.jsxs(v.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-brand-500"}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100",children:"Edit Company"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(y,{variant:"ghost",icon:U,onClick:()=>{g(!1),m({...a})},children:"Cancel"}),e.jsx(y,{variant:"primary",icon:_,onClick:p,children:"Save"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(u,{label:"Company Name *",value:s.name,onChange:t=>n("name",t.target.value)}),e.jsx(u,{label:"Trading Name",value:s.tradingName,onChange:t=>n("tradingName",t.target.value)}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{label:"Registration No.",value:s.registrationNumber,onChange:t=>n("registrationNumber",t.target.value)}),e.jsx(u,{label:"VAT No.",value:s.vatNumber,onChange:t=>n("vatNumber",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{label:"Industry",value:s.industry,onChange:t=>n("industry",t.target.value)}),e.jsx(u,{label:"Website",value:s.website,onChange:t=>n("website",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{label:"Phone",value:s.phone,onChange:t=>n("phone",t.target.value)}),e.jsx(u,{label:"Email",value:s.email,onChange:t=>n("email",t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{label:"Address Line 1",value:s.address?.[0]||"",onChange:t=>r(0,t.target.value)}),e.jsx(u,{label:"Address Line 2",value:s.address?.[1]||"",onChange:t=>r(1,t.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(u,{label:"City",value:s.city,onChange:t=>n("city",t.target.value)}),e.jsx(u,{label:"Province",value:s.province,onChange:t=>n("province",t.target.value)}),e.jsx(u,{label:"Postal Code",value:s.postalCode,onChange:t=>n("postalCode",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Pipeline Stage"}),e.jsx("select",{value:s.pipelineStage,onChange:t=>n("pipelineStage",t.target.value),className:"input w-full text-sm",children:ue.map(t=>e.jsx("option",{value:t.key,children:t.label},t.key))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(u,{label:"Estimated Value (R)",type:"number",value:String(s.estimatedValue||""),onChange:t=>n("estimatedValue",t.target.value)}),e.jsx(u,{label:"Credit Limit (R)",type:"number",value:String(s.creditLimit||""),onChange:t=>n("creditLimit",t.target.value)}),e.jsx(u,{label:"Payment Terms (days)",type:"number",value:String(s.paymentTerms||""),onChange:t=>n("paymentTerms",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-surface-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:s.notes,onChange:t=>n("notes",t.target.value),className:"input w-full text-sm min-h-[80px] resize-y"})]})]})]},"edit"):e.jsxs(v.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-brand-500"}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100",children:"Company Info"})]}),e.jsx(y,{variant:"ghost",icon:z,onClick:()=>g(!0),children:"Edit"})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-surface-400 w-28",children:"Stage"}),e.jsx(me,{stage:a.pipelineStage})]}),a.tradingName&&e.jsx(N,{label:"Trading As",value:a.tradingName}),a.registrationNumber&&e.jsx(N,{label:"Reg. No.",value:a.registrationNumber}),a.vatNumber&&e.jsx(N,{label:"VAT No.",value:a.vatNumber}),a.industry&&e.jsx(N,{label:"Industry",value:a.industry}),a.website&&e.jsx(N,{label:"Website",value:a.website}),a.phone&&e.jsx(N,{label:"Phone",value:a.phone}),a.email&&e.jsx(N,{label:"Email",value:a.email}),a.address?.filter(Boolean).length>0&&e.jsx(N,{label:"Address",value:a.address.filter(Boolean).join(", ")}),(a.city||a.province)&&e.jsx(N,{label:"City/Province",value:[a.city,a.province].filter(Boolean).join(", ")}),a.estimatedValue>0&&e.jsx(N,{label:"Est. Value",value:`R ${a.estimatedValue.toLocaleString()}`}),a.notes&&e.jsxs("div",{children:[e.jsx("div",{className:"text-surface-400 mb-1",children:"Notes"}),e.jsx("div",{className:"text-surface-300 whitespace-pre-wrap",children:a.notes})]})]})]},"view")})})}function N({label:a,value:i}){return e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"text-surface-400 w-28 flex-shrink-0",children:a}),e.jsx("span",{className:"text-surface-200",children:i})]})}function je({contact:a,onEdit:i,onDelete:l}){return e.jsxs("div",{className:"bg-surface-800/40 border border-surface-700/50 rounded-lg p-3 flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-surface-700/50 rounded-lg",children:e.jsx(ee,{className:"w-4 h-4 text-surface-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-surface-100",children:[a.firstName," ",a.lastName]}),a.isPrimary&&e.jsxs("span",{className:"flex items-center gap-0.5 text-[10px] px-1.5 py-0.5 bg-amber-500/20 text-amber-400 rounded-full",children:[e.jsx(ve,{className:"w-2.5 h-2.5"})," Primary"]})]}),a.title&&e.jsx("div",{className:"text-xs text-surface-400",children:a.title}),a.email&&e.jsx("div",{className:"text-xs text-surface-400",children:a.email}),a.phone&&e.jsx("div",{className:"text-xs text-surface-400",children:a.phone})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:i,className:"p-1 text-surface-500 hover:text-surface-300 transition-colors",children:e.jsx(z,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:l,className:"p-1 text-surface-500 hover:text-red-400 transition-colors",children:e.jsx(M,{className:"w-3.5 h-3.5"})})]})]})}function F({companyId:a,existingContact:i,onSaved:l,onCancel:g}){const[s,m]=c.useState({firstName:i?.firstName||"",lastName:i?.lastName||"",title:i?.title||"",email:i?.email||"",phone:i?.phone||"",isPrimary:i?.isPrimary||!1}),[h,d]=c.useState(!1),{saveContact:f,updateContact:p}=D(),n=async r=>{if(r.preventDefault(),!s.firstName.trim()||!s.lastName.trim()){b.error("First and last name required");return}d(!0);try{i?(await p(i.id,{firstName:s.firstName.trim(),lastName:s.lastName.trim(),title:s.title.trim(),email:s.email.trim(),phone:s.phone.trim(),isPrimary:s.isPrimary}),b.success("Contact updated")):(await f({companyId:a,firstName:s.firstName.trim(),lastName:s.lastName.trim(),title:s.title.trim(),email:s.email.trim(),phone:s.phone.trim(),isPrimary:s.isPrimary}),b.success("Contact created")),l()}catch{b.error("Failed to save contact")}finally{d(!1)}};return e.jsxs("form",{onSubmit:n,className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{label:"First Name *",value:s.firstName,onChange:r=>m({...s,firstName:r.target.value}),autoFocus:!0}),e.jsx(u,{label:"Last Name *",value:s.lastName,onChange:r=>m({...s,lastName:r.target.value})})]}),e.jsx(u,{label:"Title",value:s.title,onChange:r=>m({...s,title:r.target.value}),placeholder:"e.g., Fleet Manager"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(u,{label:"Email",type:"email",value:s.email,onChange:r=>m({...s,email:r.target.value})}),e.jsx(u,{label:"Phone",type:"tel",value:s.phone,onChange:r=>m({...s,phone:r.target.value})})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-surface-300",children:[e.jsx("input",{type:"checkbox",checked:s.isPrimary,onChange:r=>m({...s,isPrimary:r.target.checked}),className:"w-4 h-4 rounded border-surface-600 bg-surface-700 text-brand-500 focus:ring-brand-500"}),"Primary Contact"]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(y,{type:"submit",variant:"primary",icon:_,loading:h,children:i?"Update":"Save"}),e.jsx(y,{type:"button",variant:"ghost",icon:U,onClick:g,disabled:h,children:"Cancel"})]})]})}function Ne({companyId:a}){const[i,l]=c.useState([]),[g,s]=c.useState(!1),[m,h]=c.useState(null),{getByCompany:d,deleteContact:f}=D(),{confirm:p,ConfirmDialogElement:n}=O(),r=async()=>{const x=await d(a);l(x)};c.useEffect(()=>{r()},[a]);const t=async x=>{await p({title:"Delete Contact",message:"Are you sure you want to delete this contact? This action cannot be undone.",variant:"danger",confirmText:"Delete"})&&(await f(x),b.success("Contact deleted"),r())};return e.jsxs("div",{className:"glass rounded-xl p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-brand-500"}),e.jsx("h3",{className:"text-lg font-semibold text-surface-100",children:"Contacts"}),e.jsx("span",{className:"text-xs text-surface-500 bg-surface-700/50 px-1.5 py-0.5 rounded-full",children:i.length})]}),e.jsx(y,{variant:"ghost",icon:Y,onClick:()=>{s(!0),h(null)},children:"Add"})]}),g&&!m&&e.jsx("div",{className:"mb-4 p-3 bg-surface-800/40 border border-surface-700/50 rounded-lg",children:e.jsx(F,{companyId:a,onSaved:()=>{s(!1),r()},onCancel:()=>s(!1)})}),e.jsx(v.div,{className:"space-y-2",variants:k,initial:"hidden",animate:"visible",children:i.length===0&&!g?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-surface-500",children:[e.jsx(v.div,{animate:{y:[-4,4,-4]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:e.jsx(xe,{className:"w-10 h-10 text-surface-600 mb-3"})}),e.jsx("div",{className:"text-sm font-medium text-surface-400",children:"No contacts yet"}),e.jsx("div",{className:"text-xs text-surface-600 mt-1",children:"Add a contact to get started"})]}):i.map(x=>m===x.id?e.jsx("div",{className:"p-3 bg-surface-800/40 border border-surface-700/50 rounded-lg",children:e.jsx(F,{companyId:a,existingContact:x,onSaved:()=>{h(null),r()},onCancel:()=>h(null)})},x.id):e.jsx(v.div,{variants:S,whileHover:{y:-2,boxShadow:"0 4px 16px rgba(0, 212, 255, 0.06)"},children:e.jsx(je,{contact:x,onEdit:()=>h(x.id),onDelete:()=>t(x.id)})},x.id))}),n]})}const be={note:K,call:ne,email:re,meeting:le,"site-visit":ie,"quote-created":$,"quote-sent":te,"stage-change":ge},B={note:"bg-surface-600/30 text-surface-400",call:"bg-blue-500/20 text-blue-400",email:"bg-purple-500/20 text-purple-400",meeting:"bg-amber-500/20 text-amber-400","site-visit":"bg-green-500/20 text-green-400","quote-created":"bg-teal-500/20 text-teal-400","quote-sent":"bg-brand-500/20 text-brand-400","stage-change":"bg-orange-500/20 text-orange-400"};function ye({companyId:a,refreshKey:i}){const[l,g]=c.useState([]),[s,m]=c.useState(!0),{getByCompany:h}=T();return c.useEffect(()=>{(async()=>{m(!0);const f=await h(a);g(f),m(!1)})()},[a,i]),s?e.jsxs("div",{className:"glass rounded-xl p-5",children:[e.jsxs("h3",{className:"text-sm font-semibold text-surface-300 mb-4 flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-brand-500"})," Activity Timeline"]}),e.jsx("div",{className:"space-y-3",children:[1,2,3].map(d=>e.jsx("div",{className:"h-12 bg-surface-700/50 rounded animate-pulse"},d))})]}):e.jsxs("div",{className:"glass rounded-xl p-5",children:[e.jsxs("h3",{className:"text-sm font-semibold text-surface-300 mb-4 flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4 text-brand-500"})," Activity Timeline",e.jsx("span",{className:"text-xs text-surface-500 bg-surface-700/50 px-1.5 py-0.5 rounded-full",children:l.length})]}),l.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-surface-500",children:[e.jsx(v.div,{animate:{y:[-4,4,-4]},transition:{duration:4,repeat:1/0,ease:"easeInOut"},children:e.jsx(ae,{className:"w-10 h-10 text-surface-600 mb-3"})}),e.jsx("div",{className:"text-sm font-medium text-surface-400",children:"No activities yet"}),e.jsx("div",{className:"text-xs text-surface-600 mt-1",children:"Add your first activity using the form above"})]}):e.jsxs(v.div,{className:"relative space-y-3 max-h-[500px] overflow-y-auto pr-1",variants:k,initial:"hidden",animate:"visible",children:[e.jsx("div",{className:"absolute left-[13px] top-2 bottom-2 w-px bg-gradient-to-b from-brand-500/40 via-surface-600/30 to-transparent"}),l.map(d=>{const f=be[d.type]||K,p=B[d.type]||B.note;return e.jsxs(v.div,{variants:ce,whileHover:{y:-2,backgroundColor:"rgba(255,255,255,0.03)"},className:"flex gap-3 relative rounded-lg p-1 transition-colors",children:[e.jsx(v.div,{variants:de,className:`p-1.5 rounded ${p} flex-shrink-0 mt-0.5 relative z-10`,children:e.jsx(f,{className:"w-3.5 h-3.5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-surface-200",children:d.title}),d.description&&e.jsx("div",{className:"text-xs text-surface-500 mt-0.5",children:d.description}),e.jsx("div",{className:"text-[10px] text-surface-600 mt-1",children:new Date(d.createdAt).toLocaleString("en-ZA")})]})]},d.id)})]})]})}const Ce=[{value:"note",label:"Note"},{value:"call",label:"Call"},{value:"email",label:"Email"},{value:"meeting",label:"Meeting"},{value:"site-visit",label:"Site Visit"}],we=["meeting","site-visit","call"];function Se({companyId:a,onSaved:i}){const[l,g]=c.useState("note"),[s,m]=c.useState(""),[h,d]=c.useState(""),[f,p]=c.useState(""),[n,r]=c.useState(""),[t,x]=c.useState([]),[j,E]=c.useState(!1),{saveActivity:Q}=T(),{getByCompany:G}=D(),{user:H}=q(),A=we.includes(l);c.useEffect(()=>{a&&G(a).then(x).catch(()=>x([]))},[a]),c.useEffect(()=>{A||r("")},[l,A]);const W=async o=>{if(o.preventDefault(),!!s.trim()){E(!0);try{await Q({companyId:a,contactId:f,quoteId:"",type:l,title:s.trim(),description:h.trim(),dueDate:A?n:"",createdBy:H?.id||""}),b.success("Activity logged"),m(""),d(""),p(""),r(""),i()}catch{b.error("Failed to log activity")}finally{E(!1)}}};return e.jsxs("div",{className:"glass rounded-xl p-5",children:[e.jsx("h3",{className:"text-sm font-semibold text-surface-300 mb-3",children:"Log Activity"}),e.jsxs("form",{onSubmit:W,className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:l,onChange:o=>g(o.target.value),className:"input text-sm w-32","aria-label":"Activity type",children:Ce.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))}),e.jsx(u,{placeholder:"Activity title...",value:s,onChange:o=>m(o.target.value),className:"flex-1"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"activity-contact",className:"block text-xs text-surface-400 mb-1",children:"Contact (optional)"}),e.jsxs("select",{id:"activity-contact",value:f,onChange:o=>p(o.target.value),className:"input text-sm w-full",children:[e.jsx("option",{value:"",children:"No contact linked"}),t.map(o=>e.jsxs("option",{value:o.id,children:[o.firstName," ",o.lastName,o.isPrimary?" (Primary)":"",o.title?` â€” ${o.title}`:""]},o.id))]})]}),A&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"activity-due-date",className:"block text-xs text-surface-400 mb-1",children:"Due / Scheduled date"}),e.jsx("input",{id:"activity-due-date",type:"date",value:n,onChange:o=>r(o.target.value),className:"input text-sm w-full","aria-label":"Due date"})]}),e.jsx("textarea",{placeholder:"Description (optional)",value:h,onChange:o=>d(o.target.value),className:"input w-full text-sm min-h-[60px] resize-y"}),e.jsx(y,{type:"submit",variant:"primary",icon:Y,loading:j,disabled:!s.trim(),children:"Log Activity"})]})]})}function Ae({companyId:a}){const[i,l]=c.useState([]),g=R();return c.useEffect(()=>{(async()=>{const m=await oe.quotes.where("companyId").equals(a).toArray();l(m.sort((h,d)=>d.createdAt.localeCompare(h.createdAt)))})()},[a]),e.jsxs("div",{className:"glass rounded-xl p-5",children:[e.jsxs("h3",{className:"text-sm font-semibold text-surface-300 mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4 text-brand-500"})," Linked Quotes",e.jsx("span",{className:"text-xs text-surface-500 bg-surface-700/50 px-1.5 py-0.5 rounded-full",children:i.length})]}),i.length===0?e.jsx("div",{className:"text-center text-surface-500 py-4",children:"No linked quotes"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-surface-700/50",children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-surface-400",children:"Ref"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-surface-400",children:"Date"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-surface-400",children:"Status"})]})}),e.jsx("tbody",{children:i.map(s=>e.jsxs("tr",{className:"border-b border-surface-700/30 hover:bg-surface-700/20 transition-colors cursor-pointer",onClick:()=>g("/quote"),children:[e.jsx("td",{className:"px-3 py-2 text-surface-200 font-medium",children:s.quoteRef}),e.jsx("td",{className:"px-3 py-2 text-surface-400",children:new Date(s.createdAt).toLocaleDateString("en-ZA")}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-surface-700/50 text-surface-300",children:s.status})})]},s.id))})]})})]})}const C=({className:a=""})=>e.jsx("div",{className:`animate-pulse bg-surface-700/50 rounded ${a}`}),w=()=>e.jsxs("div",{className:"glass rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(C,{className:"w-8 h-8 rounded-lg"}),e.jsx(C,{className:"h-6 w-32"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{className:"h-4 w-full"}),e.jsx(C,{className:"h-4 w-5/6"}),e.jsx(C,{className:"h-4 w-4/6"})]})]});function Oe(){const{id:a}=X(),i=R(),[l,g]=c.useState(null),[s,m]=c.useState(!0),[h,d]=c.useState(0),{getById:f,deleteCompany:p}=V(),{confirm:n,ConfirmDialogElement:r}=O(),t=async()=>{if(!a)return;const j=await f(a);g(j),m(!1)};c.useEffect(()=>{t()},[a]);const x=async()=>{!a||!await n({title:"Delete Company",message:`Are you sure you want to delete "${l?.name}"? This action cannot be undone.`,variant:"danger",confirmText:"Delete"})||(await p(a),b.success("Company deleted"),i("/customers"))};return s?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-surface-900 via-surface-800 to-surface-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-4",children:[e.jsx(P,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"w-20 h-9 rounded-lg"}),e.jsx(C,{className:"h-8 w-48"})]}),e.jsx(C,{className:"w-24 h-9 rounded-lg"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx(w,{}),e.jsx(w,{})]}),e.jsxs("div",{className:"lg:col-span-3 space-y-4",children:[e.jsx(w,{}),e.jsx(w,{}),e.jsx(w,{})]})]})]})}):l?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-surface-900 via-surface-800 to-surface-900",children:[e.jsxs(v.div,{className:"max-w-7xl mx-auto p-4 space-y-4",variants:k,initial:"hidden",animate:"visible",children:[e.jsx(v.div,{variants:S,children:e.jsx(P,{})}),e.jsxs(v.div,{variants:S,className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{variant:"ghost",icon:he,onClick:()=>i("/customers"),children:"Back"}),e.jsx("h1",{className:"text-2xl font-bold text-surface-100",children:l.name})]}),e.jsx(y,{variant:"danger",icon:M,onClick:x,children:"Delete"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4",children:[e.jsxs(v.div,{variants:S,className:"lg:col-span-2 space-y-4",children:[e.jsx(pe,{company:l,onUpdate:t}),e.jsx(Ne,{companyId:l.id})]}),e.jsxs(v.div,{variants:S,className:"lg:col-span-3 space-y-4",children:[e.jsx(Se,{companyId:l.id,onSaved:()=>d(j=>j+1)}),e.jsx(ye,{companyId:l.id,refreshKey:h}),e.jsx(Ae,{companyId:l.id})]})]})]}),r]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-surface-900 via-surface-800 to-surface-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-4",children:[e.jsx(P,{}),e.jsx("div",{className:"glass rounded-xl p-12 text-center text-surface-500",children:"Company not found"})]})})}export{Oe as default};
