import{j as e,m as c,A as f}from"./vendor-motion-BTi7gxEc.js";import{u as h,r as p}from"./vendor-react-CUuYCEpB.js";import{aA as j,aB as N,aC as g,aD as b,al as v,am as y,$ as w,a4 as k,aE as C,aF as $,a2 as A,F as R,e as I,C as F}from"./index-BQ8GchdQ.js";import{C as _}from"./chevron-left-CrGQCJ_c.js";import{I as B}from"./inbox-BOjaHzoY.js";import"./vendor-zustand-DbidXgKt.js";import"./vendor-dexie-TCJlnc2g.js";import"./vendor-pdf-tjGXvEUX.js";import"./vendor-supabase-DxKkahmj.js";function D({type:t}){const s="w-4 h-4 shrink-0";switch(t){case"approval_needed":return e.jsx(F,{className:`${s} text-warning`});case"approval_result":return e.jsx(I,{className:`${s} text-success`});case"quote_assigned":return e.jsx(R,{className:`${s} text-brand-400`});case"company_assigned":return e.jsx(A,{className:`${s} text-feature-400`});case"stage_change":return e.jsx($,{className:`${s} text-brand-300`});case"activity_mention":return e.jsx(C,{className:`${s} text-feature-300`});default:return e.jsx(k,{className:`${s} text-surface-300`})}}function M(t){const s=Date.now(),o=new Date(t).getTime();if(isNaN(o))return"";const d=Math.floor((s-o)/1e3),i=Math.floor(d/60),r=Math.floor(i/60),l=Math.floor(r/24);return d<60?"Just now":i<60?`${i}m ago`:r<24?`${r}h ago`:l===1?"Yesterday":l<7?`${l}d ago`:new Date(t).toLocaleDateString("en-ZA",{day:"numeric",month:"short",year:"numeric"})}const T=[{label:"All",value:"all"},{label:"Unread",value:"unread"},{label:"Read",value:"read"}];function S({notification:t,onRead:s,onNavigate:o}){const{id:d,type:i,title:r,message:l,isRead:x,createdAt:n}=t,m=()=>{x||s(d),o(t)};return e.jsxs(c.button,{variants:y,onClick:m,className:["w-full text-left flex items-start gap-4 px-5 py-4 transition-colors","hover:bg-surface-700/30 focus:outline-none focus-visible:bg-surface-700/30","border-l-2",x?"border-l-transparent":"border-l-brand-500"].join(" "),children:[e.jsx("div",{className:"mt-0.5 flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full bg-surface-700/60",children:e.jsx(D,{type:i})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("p",{className:["text-sm leading-snug",x?"text-surface-300 font-normal":"text-surface-100 font-semibold"].join(" "),children:r}),e.jsx("span",{className:"text-xs text-surface-500 whitespace-nowrap shrink-0 mt-0.5",children:M(n)})]}),e.jsx("p",{className:"text-xs text-surface-400 mt-1 leading-relaxed",children:l})]}),e.jsxs("div",{className:"flex flex-col items-center gap-1 pt-1",children:[!x&&e.jsx("span",{className:"w-2 h-2 rounded-full bg-brand-500","aria-hidden":"true"}),e.jsx(w,{className:"w-4 h-4 text-surface-600 mt-auto"})]})]})}function Y(){const t=h(),[s,o]=p.useState("all"),{notifications:d,unreadCount:i,isLoading:r,markAsRead:l,markAllAsRead:x}=j(),n=d.filter(a=>s==="unread"?!a.isRead:s==="read"?a.isRead:!0),m=a=>{if(!(!a.entityType||!a.entityId))switch(a.entityType){case"quote":t(`/quote?id=${a.entityId}`);break;case"company":t(`/customers/${a.entityId}`);break;case"activity":t(`/customers?activity=${a.entityId}`);break}};return e.jsx("div",{className:"min-h-screen p-4 md:p-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs(c.button,{initial:{opacity:0,x:-8},animate:{opacity:1,x:0},onClick:()=>t(-1),className:"flex items-center gap-1.5 text-sm text-surface-400 hover:text-surface-100 mb-5 transition-colors",children:[e.jsx(_,{className:"w-4 h-4"}),"Back"]}),e.jsxs(c.div,{initial:{opacity:0,y:-12},animate:{opacity:1,y:0},className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 flex items-center justify-center rounded-lg bg-brand-600/20",children:e.jsx(N,{className:"w-5 h-5 text-brand-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-surface-100",children:"Notifications"}),i>0&&e.jsxs("p",{className:"text-xs text-surface-400",children:[i," unread"]})]})]}),i>0&&e.jsxs(c.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:x,className:"flex items-center gap-1.5 text-sm text-brand-400 hover:text-brand-300 transition-colors px-3 py-1.5 bg-brand-600/10 hover:bg-brand-600/20 rounded-lg",children:[e.jsx(g,{className:"w-4 h-4"}),"Mark all read"]})]}),e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},className:"flex gap-1 mb-4 p-1 bg-surface-800/60 rounded-lg w-fit",children:T.map(a=>e.jsxs("button",{onClick:()=>o(a.value),className:["px-4 py-1.5 rounded-md text-sm font-medium transition-all",s===a.value?"bg-brand-600/25 text-brand-300":"text-surface-400 hover:text-surface-200"].join(" "),children:[a.label,a.value==="unread"&&i>0&&e.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 bg-danger text-white text-2xs rounded-full font-bold",children:i})]},a.value))}),e.jsx("div",{className:"glass rounded-xl overflow-hidden",children:r&&n.length===0?e.jsx("div",{className:"flex flex-col gap-3 p-5",children:[...Array(5)].map((a,u)=>e.jsxs("div",{className:"flex items-start gap-4 animate-pulse",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-surface-700 shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3.5 bg-surface-700 rounded w-2/3"}),e.jsx("div",{className:"h-3 bg-surface-700 rounded w-full"})]})]},u))}):n.length===0?e.jsx("div",{className:"flex flex-col items-center justify-center py-16 px-6 text-center",children:e.jsx(f,{mode:"wait",children:e.jsx(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex flex-col items-center",children:s==="unread"?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-12 h-12 text-surface-600 mb-3"}),e.jsx("p",{className:"text-sm font-medium text-surface-300",children:"All caught up"}),e.jsx("p",{className:"text-xs text-surface-500 mt-1",children:"No unread notifications."})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-12 h-12 text-surface-600 mb-3"}),e.jsx("p",{className:"text-sm font-medium text-surface-300",children:"No notifications yet"}),e.jsx("p",{className:"text-xs text-surface-500 mt-1",children:"Notifications will appear here as activity happens."})]})},s)})}):e.jsx(c.div,{variants:v,initial:"hidden",animate:"visible",className:"divide-y divide-surface-700/40",children:n.map(a=>e.jsx(S,{notification:a,onRead:l,onNavigate:m},a.id))},s)}),n.length>0&&e.jsxs("p",{className:"text-center text-xs text-surface-600 mt-4",children:["Showing ",n.length," notification",n.length!==1?"s":""]})]})})}export{Y as default};
